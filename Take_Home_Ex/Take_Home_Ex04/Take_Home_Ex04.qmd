---
title: "Take-Home Exercise 4"
author: "Bhairavi"
date: "26 February 2023"
execute:
  warning: false
format: html
editor: visual
---

xx

load the libraries

```{r}
pacman::p_load(lubridate, readxl, tidyverse)
```

load the dataset
ignore the top and bottom rows

```{r}
merchImportRaw <- read_xlsx("outputFile.xlsx",
                       sheet = "T1",
                       skip = 9)

merchImport <- slice(merchImportRaw,
                     2:(n() - 23))
```

exclude columns which are not in this range: **January 2020 to December 2022**

```{r}
merchImport <- merchImport %>%
  select(1, 3:38)
```

covert all rows which are in the millions format to be in the thousands format, or split these rows into another dataframe

```{r}
merchImportMills <- slice(merchImport,
                          1:6)
merchImportThous <- slice(merchImport,
                          7:n())
```

pivot the values for the date range: covert to one column to contain the month year, and one column to contain the amount in thousands

```{r}
merchImportMills <- merchImportMills %>%
  pivot_longer(cols = !`Data Series`,
               names_to = "Period",
               values_to = "Amount")

merchImportThous <- merchImportThous %>%
  pivot_longer(cols = !`Data Series`,
               names_to = "Period",
               values_to = "Amount")
```

split the period column into a year and month column

```{r}
merchImportMills <- merchImportMills %>%
  mutate(Date = as.Date(paste(Period, "01"),
                        "%Y %B %d")) %>%
  mutate(Year = year(Date)) %>%
  mutate(Quarter = quarters(Date)) %>%
  mutate(Month = month(Date))

merchImportThous <- merchImportThous %>%
  mutate(Date = as.Date(paste(Period, "01"),
                        "%Y %B %d")) %>%
  mutate(Year = year(Date)) %>%
  mutate(Quarter = quarters(Date)) %>%
  mutate(Month = month(Date))
```

xx